<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>圖片顯示測試</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ccc; }
        .test-image { max-width: 200px; margin: 10px; border: 2px solid #ddd; }
        .success { border-color: green; }
        .error { border-color: red; }
        .log { background: #f5f5f5; padding: 10px; margin: 10px 0; font-family: monospace; }
    </style>
</head>
<body>
    <h1>圖片顯示測試</h1>
    
    <div class="test-section">
        <h2>測試 1: 直接後端訪問</h2>
        <img id="direct-img" class="test-image" 
             src="http://localhost:3004/uploads/materials/LOGO-1760475135350-196807851.png" 
             alt="Direct Backend Access">
        <div class="log" id="direct-log">載入中...</div>
    </div>
    
    <div class="test-section">
        <h2>測試 2: 前端代理訪問</h2>
        <img id="proxy-img" class="test-image" 
             src="http://localhost:3000/uploads/materials/LOGO-1760475135350-196807851.png" 
             alt="Frontend Proxy Access">
        <div class="log" id="proxy-log">載入中...</div>
    </div>
    
    <div class="test-section">
        <h2>測試 3: 相對路徑訪問</h2>
        <img id="relative-img" class="test-image" 
             src="/uploads/materials/LOGO-1760475135350-196807851.png" 
             alt="Relative Path Access">
        <div class="log" id="relative-log">載入中...</div>
    </div>
    
    <script>
        function setupImageTest(imgId, logId, description) {
            const img = document.getElementById(imgId);
            const log = document.getElementById(logId);
            
            img.onload = function() {
                img.classList.add('success');
                log.textContent = `✅ ${description} 成功載入 (${img.naturalWidth}x${img.naturalHeight})`;
                log.style.color = 'green';
            };
            
            img.onerror = function() {
                img.classList.add('error');
                log.textContent = `❌ ${description} 載入失敗`;
                log.style.color = 'red';
            };
        }
        
        setupImageTest('direct-img', 'direct-log', '直接後端訪問');
        setupImageTest('proxy-img', 'proxy-log', '前端代理訪問');
        setupImageTest('relative-img', 'relative-log', '相對路徑訪問');
        
        // 測試 fetch API
        setTimeout(() => {
            const testUrls = [
                'http://localhost:3004/uploads/materials/LOGO-1760475135350-196807851.png',
                'http://localhost:3000/uploads/materials/LOGO-1760475135350-196807851.png',
                '/uploads/materials/LOGO-1760475135350-196807851.png'
            ];
            
            testUrls.forEach((url, index) => {
                fetch(url)
                    .then(response => {
                        console.log(`Fetch test ${index + 1} (${url}):`, response.status, response.statusText);
                    })
                    .catch(error => {
                        console.error(`Fetch test ${index + 1} (${url}) failed:`, error);
                    });
            });
        }, 1000);
    </script>
</body>
</html>