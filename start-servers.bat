@echo off
chcp 65001 >nul
title é›²æ°´åŸºæç®¡ç†ç³»çµ± - æœå‹™å™¨å•Ÿå‹•

echo.
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                    ðŸš€ é›²æ°´åŸºæç®¡ç†ç³»çµ±                        â•‘
echo â•‘                      æœå‹™å™¨å•Ÿå‹•è…³æœ¬                          â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

REM æª¢æŸ¥ Node.js æ˜¯å¦å®‰è£
node --version >nul 2>&1
if errorlevel 1 (
    echo âŒ éŒ¯èª¤: æœªæ‰¾åˆ° Node.js
    echo è«‹å…ˆå®‰è£ Node.js: https://nodejs.org/
    pause
    exit /b 1
)

REM æª¢æŸ¥ npm æ˜¯å¦å¯ç”¨
npm --version >nul 2>&1
if errorlevel 1 (
    echo âŒ éŒ¯èª¤: æœªæ‰¾åˆ° npm
    pause
    exit /b 1
)

echo âœ… Node.js ç’°å¢ƒæª¢æŸ¥é€šéŽ
echo.

REM åœæ­¢å¯èƒ½æ­£åœ¨é‹è¡Œçš„æœå‹™
echo ðŸ§¹ æ¸…ç†ç¾æœ‰æœå‹™...
call stop-servers.bat >nul 2>&1

echo.
echo ðŸ“¦ æª¢æŸ¥å’Œå®‰è£ä¾è³´...

REM æª¢æŸ¥å¾Œç«¯ä¾è³´
echo æª¢æŸ¥å¾Œç«¯ä¾è³´...
cd backend
if not exist node_modules (
    echo ðŸ“¥ å®‰è£å¾Œç«¯ä¾è³´...
    npm install
    if errorlevel 1 (
        echo âŒ å¾Œç«¯ä¾è³´å®‰è£å¤±æ•—
        pause
        exit /b 1
    )
) else (
    echo âœ… å¾Œç«¯ä¾è³´å·²å­˜åœ¨
)

REM æª¢æŸ¥å‰ç«¯ä¾è³´
echo æª¢æŸ¥å‰ç«¯ä¾è³´...
cd ../frontend
if not exist node_modules (
    echo ðŸ“¥ å®‰è£å‰ç«¯ä¾è³´...
    npm install
    if errorlevel 1 (
        echo âŒ å‰ç«¯ä¾è³´å®‰è£å¤±æ•—
        pause
        exit /b 1
    )
) else (
    echo âœ… å‰ç«¯ä¾è³´å·²å­˜åœ¨
)

cd ..

echo.
echo ðŸ”§ å•Ÿå‹•æœå‹™å™¨...

REM å•Ÿå‹•å¾Œç«¯æœå‹™
echo å•Ÿå‹•å¾Œç«¯æœå‹™ (ç«¯å£ 3004)...
cd backend
start "é›²æ°´ç³»çµ± - å¾Œç«¯æœå‹™ (Port 3004)" cmd /k "echo ðŸ”§ å¾Œç«¯æœå‹™å•Ÿå‹•ä¸­... && npm run dev"

REM ç­‰å¾…å¾Œç«¯å•Ÿå‹•
echo ç­‰å¾…å¾Œç«¯æœå‹™å•Ÿå‹•...
timeout /t 5 /nobreak >nul

REM å•Ÿå‹•å‰ç«¯æœå‹™
echo å•Ÿå‹•å‰ç«¯æœå‹™ (ç«¯å£ 3002)...
cd ../frontend
start "é›²æ°´ç³»çµ± - å‰ç«¯æœå‹™ (Port 3002)" cmd /k "echo ðŸŽ¨ å‰ç«¯æœå‹™å•Ÿå‹•ä¸­... && npm run dev"

REM ç­‰å¾…å‰ç«¯å•Ÿå‹•
echo ç­‰å¾…å‰ç«¯æœå‹™å•Ÿå‹•...
timeout /t 3 /nobreak >nul

echo.
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                      âœ… å•Ÿå‹•å®Œæˆï¼                           â•‘
echo â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
echo â•‘  ðŸ“± å‰ç«¯æ‡‰ç”¨:     http://localhost:3002/                     â•‘
echo â•‘  ðŸ”§ å¾Œç«¯ API:     http://localhost:3004/                     â•‘
echo â•‘  ðŸ“Š å¥åº·æª¢æŸ¥:     http://localhost:3004/health               â•‘
echo â•‘  ðŸ§ª çµ„ä»¶æ¸¬è©¦:     frontend/test-components.html              â•‘
echo â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
echo â•‘  ðŸ’¡ ä½¿ç”¨èªªæ˜Ž:                                                â•‘
echo â•‘  â€¢ å…©å€‹æœå‹™æœƒåœ¨æ–°çš„å‘½ä»¤è¦–çª—ä¸­é‹è¡Œ                              â•‘
echo â•‘  â€¢ é—œé–‰å°æ‡‰çš„å‘½ä»¤è¦–çª—å³å¯åœæ­¢æœå‹™                              â•‘
echo â•‘  â€¢ æˆ–è€…é‹è¡Œ stop-servers.bat åœæ­¢æ‰€æœ‰æœå‹™                     â•‘
echo â•‘  â€¢ ä½¿ç”¨æ¼”ç¤ºå¸³è™Ÿç™»å…¥: admin/admin123                           â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

REM ç­‰å¾…å¹¾ç§’å¾Œè‡ªå‹•æ‰“é–‹ç€è¦½å™¨
echo ðŸŒ 5ç§’å¾Œè‡ªå‹•æ‰“é–‹ç€è¦½å™¨...
timeout /t 5 /nobreak >nul

REM æ‰“é–‹ç€è¦½å™¨
start http://localhost:3002/

echo.
echo ðŸŽ‰ ç³»çµ±å·²æˆåŠŸå•Ÿå‹•ï¼
echo æŒ‰ä»»æ„éµé—œé–‰æ­¤è¦–çª—...
pause >nul