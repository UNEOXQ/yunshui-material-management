# 手機應用 - 完整後端測試指南

## ✅ 問題已解決

### 修復內容
- ✅ 修復了OrderController中的getOrders方法
- ✅ 直接使用內存數據庫而不是PostgreSQL
- ✅ 添加了完整的items信息用於手機應用
- ✅ 保持與PC版的兼容性

### 測試結果
```
✅ 完整後端正常運行 (npm run dev)
✅ 訂單API返回8個訂單
✅ 包含完整的材料信息和數量
✅ 支援角色權限過濾
```

## 📱 手機應用測試步驟

### 1. 確認後端運行
完整後端已經在運行，端點：
- 🔗 http://192.168.68.95:3004/api/orders
- 🔗 http://192.168.68.95:3004/api/materials
- 🔗 http://192.168.68.95:3004/api/auth/login

### 2. 重新載入手機應用
在Expo Go中：
- 搖動設備打開開發者菜單
- 點擊 "Reload" 重新載入應用
- 或關閉Expo Go重新掃描QR碼

### 3. 測試不同角色

#### Jeffrey (PM) - 應該看到8個輔材訂單
- 快速登入: Jeffrey
- 檢查儀表板「總訂單數」應該顯示 **8**
- 點擊「🔧 輔材訂單管理」
- 應該看到8個輔材訂單，包含材料詳情

#### 測試其他用戶
- **Miya (AM)**: 登入後測試完成材訂單
- **Mark (WAREHOUSE)**: 登入後查看所有訂單狀態
- **系統管理員**: 可以看到所有功能

### 4. 驗證數據同步
- 在PC版創建新訂單
- 在手機版重新載入或重新登入
- 應該能看到新訂單

## 🎯 預期結果

### Jeffrey (PM) 測試結果
- ✅ 儀表板顯示「總訂單數: 8」
- ✅ 輔材訂單管理頁面顯示8個訂單
- ✅ 每個訂單顯示材料名稱和數量
- ✅ 可以創建新的輔材訂單

### 訂單詳情示例
```
📋 Order id-2121: 螺絲釘 M6x20 x 1
📋 Order id-2113: 螺絲釘 M6x20 x 1, 電線 2.5mm² x 1
📋 Order order-1: 螺絲釘 M6x20 x 100
```

## 🔧 技術細節

### API響應格式
```json
{
  "success": true,
  "data": {
    "orders": [
      {
        "id": "order-1",
        "userId": "user-2",
        "status": "PENDING",
        "totalAmount": 250,
        "items": [
          {
            "materialId": "material-1",
            "materialName": "螺絲釘 M6x20",
            "quantity": 100,
            "price": 2.5
          }
        ]
      }
    ]
  }
}
```

### 手機應用過濾邏輯
- **PM**: 顯示所有自己的訂單 (輔材為主)
- **AM**: 顯示完成材訂單
- **WAREHOUSE**: 顯示所有訂單
- **ADMIN**: 顯示所有訂單

## 🎉 成功！

現在PC版和手機版使用同一個後端，數據完全同步！

---

**修復時間**: 2024年10月29日  
**狀態**: 完整後端已修復，手機應用準備測試